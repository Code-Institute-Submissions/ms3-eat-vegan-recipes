{% extends "base.html" %}
{% block content %}

<!-- Header -->
<header class="masthead-small d-flex">
    <div class="container text-center my-auto">
        <h1 id="site-header-name" class="mb-1 text-stroke-effect">Eat Vegan</h1>
    </div>
    <div class="overlay"></div>
</header>

<!-- Recipe Header -->

<div class="container">
    <div class="recipe-title-wrapper">
        <div class="row">
            <div class="col d-flex justify-content-center">
                <h1>{{ recipe.name }}</h1>
            </div>
        </div>
        <div class=" row title-source">
            <div class="col d-flex justify-content-center byline-source">
                <h4>By {{ recipe.added_by }}</h4>
            </div>
        </div>
        <div id="reviews-header" class="recipe-sidebar row">
            <div class="col d-flex flex-column align-items-center">
                <div class="review-rating">
                    <p id="recipe-description" class="align-self-center">{{ recipe.short_description }}</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Image -->

<div class="container">
    <div class="row" id="recipe-card">
        <div class="col p-0  d-flex justify-content-center ">
            <div class="image-wrap">
                <img class="img-fluid recipe-page-img" src="{{ recipe.img_url }}">
                <p id="recipe-image-overlay-text">This recipe has been recommended <span class="vote-count" itemprop="reviewCount">{{ recipe.votes }}</span>x</p>
            </div>
        </div>
    </div>

<!-- Call for action buttons -->
{% if user %}
<div class="container">
    <div class="row">
        <div id="recipe-buttons" class="col d-flex justify-content-center align-items-start">
            {% if username != recipe.added_by %}
            <form method="POST" action="{{ url_for('add_recommendation', recipe_id=recipe._id) }}">
                <button type="submit" id="submit-recommendation" class="btn btn-small btn-primary recipe-btn">Recommend Recipe
                </button>
            </form>
            {% endif %}
            <a href="{{ url_for('edit_recipe', recipe_id=recipe._id) }}" id="edit-recipe" class="btn btn-small btn-warning recipe-btn">Edit Recipe</a>
            <a href="{{ url_for('delete_recipe', recipe_id=recipe._id) }}" id="delete-recipe" class="btn btn-small btn-danger recipe-btn">Delete Recipe</a>
        </div>
    </div>
</div>
{% endif %}

<!-- Recipe details -->
    <div id="recipe-detail-container" class="row">
        <div class="col-lg-7 pl-0 pt-3 d-flex flex-column justify-content-center">
            {% for step in recipe.method %}
            <p class="align-self-center recipe-method">{{ step }}</p>
            {% endfor %}
        </div>
        <div class="col-lg-5 order-first order-lg-last d-flex flex-column justify-content-start">
            <p class="recipe-stats">Preptime - {{ recipe.recipe_info[1] }} minutes</p>
            <p class="recipe-stats">Cooktime - {{ recipe.recipe_info[2] }} minutes</p>
            <p class="recipe-stats">Serves - {{ recipe.recipe_info[0] }} minutes</p>
            <ul id="recipe-ingredients"class="align-self-center">
                {% for item in recipe.ingredients %}
                    <li class="">{{ item }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>

<!-- Reviews -->

<div class="container" id="reviews">
    <div class="row">
        <div class="col mt-3 d-flex justify-content-start">
            <h2>Reviews</h2>
        </div>
    </div>
    <hr class="review-break">
    {% for review in reviews %}
    <div class="row">
        <div class="col d-flex flex-column">
            <h3>{{ review.recipe_rating }} / 5 - Reviewed by: {{ review.added_by }}</h3>
            <p>{{ review.recipe_review }}</p>
            <hr class="review-break">
        </div>
    </div>
    {% endfor %}
</div>

{% if session.user %}

<div id="add-review-container" class="container">

        <!-- Form -->

        <form class="col" method="POST" action="{{ url_for('add_review', recipe_id=recipe._id) }}">

            <!-- recipe review -->

            <div class="row">
                <div class="col">
                    <div class="">
                        <div class="">
                            <h5>Leave a review here:</h5>
                            <textarea id="recipe_review" name="recipe_review" rows="5" cols="90"></textarea>
                            <label class="" for="recipe_review"></label>
                        </div>
                    </div>
                </div>
            </div>

            <!-- recipe rating -->

            <div class="row">
                <div class="col-lg-8 d-flex justify-content-start">
                    <div class="mat-input" id="mat-input-rating">
                        <div class="mat-input-outer">
                            <h5>Recipe Rating - Out Of 5</h5>
                            <input id="recipe_rating" class="range" name="recipe_rating" type="range" min="0" max="5" required>
                            <output class="bubble"></output>
                            <label class="" for="recipe_rating"></label>
                        </div>
                    </div>
                </div>

            <!-- submit button -->

                <div class="col d-flex justify-content-center justify-content-lg-end">
                    <button type="submit" id="submit" class="btn btn-large">
                        Add Review
                    </button>
                </div>

            </div>

        </form>
</div>
{% else %}
    <div class="row">
        <div class="col d-flex justify-content-center">
            <a href="{{ url_for('login') }}" class="btn btn-lg btn-light mb-4 mt-4">Add A Review</a>
        </div>
    </div>
{% endif %}


<!-- Call to Action Buttons -->
  <section class="content-section bg-dark text-white">
    <div class="container text-center">
      <h2 class="mb-12">View more of our community submitted recipes, or add your own recipe to the site. Get Started Below</h2>
      <a href="{{ url_for('recipes') }}" class="btn btn-xl btn-primary mt-3">Back To All Recipes!</a>
      <a href="{{ url_for('add_recipe') }}" class="btn btn-xl btn-primary mt-3">Add Recipe!</a>
    </div>
  </section>


{% endblock %}